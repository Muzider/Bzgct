# 标准工艺流程设置模块使用说明

## 模块概述

标准工艺流程设置模块是基础设置模块的子模块，用于为各个船型的典型分段设置标准工艺流程。该模块支持并行执行设置，允许某些作业工序可以同时进行。

## 主要功能

### 1. 工艺流程管理
- **创建工艺流程**：为特定船型和典型分段创建标准工艺流程
- **编辑工艺流程**：修改工艺流程的基本信息和步骤
- **删除工艺流程**：软删除工艺流程（标记为不可用）
- **查看详情**：查看工艺流程的详细信息和步骤

### 2. 工艺步骤管理
- **添加步骤**：向工艺流程中添加具体的工艺步骤
- **设置执行顺序**：定义步骤的执行先后顺序
- **并行执行设置**：通过并行组号设置可并行执行的步骤
- **预估工时**：为每个步骤设置预估工时，支持自动计算

### 3. 并行执行特性
- **顺序执行**：并行组号为0的步骤按顺序执行
- **并行执行**：相同并行组号的步骤可以同时执行
- **可视化展示**：提供流程图的直观展示

## 使用方法

### 1. 访问模块
- 从系统首页进入"基础设置"模块
- 点击"标准工艺流程"按钮
- 或直接访问：`/drawings/standard-process-flow/`

### 2. 创建工艺流程
1. 点击"新增工艺流程"按钮
2. 填写工艺流程名称（必填）
3. 选择船型（必填）
4. 选择典型分段（必填）
5. 填写工艺流程描述（可选）
6. 点击"创建工艺流程"保存

### 3. 添加工艺步骤
1. 创建工艺流程后，点击"编辑"进入编辑页面
2. 在"工艺流程步骤"部分点击"添加步骤"
3. 填写步骤信息：
   - 步骤名称
   - 选择作业工序
   - 设置执行顺序
   - 设置并行组号
   - 预估工时（可选，会自动填充）
   - 步骤描述（可选）
4. 点击"保存工艺流程步骤"

### 4. 并行执行设置
- **并行组号0**：表示顺序执行
- **并行组号1**：表示第一组并行步骤
- **并行组号2**：表示第二组并行步骤
- 相同组号的步骤可以同时执行，不同组号按顺序执行

## 数据模型

### StandardProcessFlow（标准工艺流程）
- `name`: 工艺流程名称
- `ship_type`: 关联船型
- `typical_section`: 关联典型分段
- `description`: 工艺流程描述
- `estimated_total_hours`: 预估总工时（自动计算）
- `is_active`: 是否启用

### ProcessFlowStep（工艺流程步骤）
- `process_flow`: 所属工艺流程
- `work_process`: 关联作业工序
- `step_name`: 步骤名称
- `step_order`: 执行顺序
- `parallel_group`: 并行组号
- `estimated_hours`: 预估工时
- `prerequisites`: 前置步骤（多对多关系）
- `description`: 步骤描述

## 技术特性

### 1. 自动计算
- 预估总工时自动计算：基于所有步骤的预估工时总和
- 步骤工时自动填充：从作业工序的标准工时获取

### 2. 数据验证
- 唯一性约束：同一船型和典型分段下工艺流程名称唯一
- 步骤顺序约束：同一工艺流程内步骤顺序唯一
- 关联性验证：确保步骤关联的作业工序存在

### 3. 用户界面
- 响应式设计：支持不同屏幕尺寸
- 动态交互：JavaScript实现的步骤管理
- 统一风格：使用标准化的按钮和样式

## 使用场景示例

### 集装箱船绑扎桥分段工艺流程
1. **准备工作**（并行组号0，顺序执行）
   - 材料准备
   - 设备检查
   - 人员安排

2. **主体施工**（并行组号1，并行执行）
   - 焊接作业
   - 装配作业
   - 检验作业

3. **收尾工作**（并行组号0，顺序执行）
   - 表面处理
   - 最终检验
   - 清理现场

## 注意事项

1. **删除操作**：删除工艺流程会同时删除所有相关步骤，此操作不可恢复
2. **并行设置**：合理设置并行组号可以优化施工效率
3. **工时估算**：预估工时影响项目计划和成本核算，请谨慎设置
4. **步骤顺序**：执行顺序决定了施工的先后关系，请合理安排

## 系统要求

- Django 5.2+
- Python 3.8+
- 支持现代浏览器的JavaScript
- 数据库：SQLite/MySQL/PostgreSQL

## 技术支持

如遇到问题，请检查：
1. 浏览器控制台是否有JavaScript错误
2. Django服务器日志是否有错误信息
3. 数据库连接是否正常
4. 相关模型是否正确创建

---

*本模块为船舶制造行业提供标准化的工艺流程管理解决方案*
